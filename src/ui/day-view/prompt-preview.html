<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Preview</title>
  <style>
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f8f9fa;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --border-color: #e5e7eb;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-primary: #1a1a2e;
        --bg-secondary: #16213e;
        --text-primary: #e0e0e0;
        --text-secondary: #9ca3af;
        --border-color: #374151;
      }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      padding: 24px;
      max-width: 900px;
      margin: 0 auto;
    }
    h1 { font-size: 20px; margin-bottom: 4px; }
    .subtitle { font-size: 13px; color: var(--text-secondary); margin-bottom: 24px; }
    .controls {
      display: flex;
      gap: 16px;
      align-items: center;
      margin-bottom: 24px;
      padding: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }
    .controls label { font-size: 13px; font-weight: 500; }
    .controls select {
      padding: 4px 8px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }
    h2 { font-size: 15px; margin: 24px 0 12px; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
      font-size: 13px;
    }
    th {
      text-align: left;
      padding: 8px 10px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      color: var(--text-secondary);
    }
    td {
      padding: 8px 10px;
      border: 1px solid var(--border-color);
      vertical-align: top;
    }
    .prompt-cell {
      font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
      font-size: 12px;
      white-space: pre-wrap;
      line-height: 1.5;
      background: var(--bg-secondary);
    }
    .event-label {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .event-meta {
      font-size: 11px;
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <h1>Prompt Builder Preview</h1>
  <p class="subtitle">Shows the exact prompts generated by prompt-builders.ts for RSVP actions and slot selection.</p>

  <div class="controls">
    <label for="locale-select">Locale:</label>
    <select id="locale-select">
      <option value="en-US">en-US</option>
      <option value="en-GB">en-GB</option>
      <option value="de-DE">de-DE</option>
      <option value="fr-FR">fr-FR</option>
      <option value="ja-JP">ja-JP</option>
      <option value="es-ES">es-ES</option>
      <option value="zh-CN">zh-CN</option>
    </select>
  </div>

  <h2>RSVP Prompts</h2>
  <table>
    <thead>
      <tr>
        <th>Event</th>
        <th>Accept</th>
        <th>Maybe</th>
        <th>Decline</th>
      </tr>
    </thead>
    <tbody id="rsvp-table"></tbody>
  </table>

  <h2>Slot Selection Prompts</h2>
  <table>
    <thead>
      <tr>
        <th>Slot</th>
        <th>Prompt</th>
      </tr>
    </thead>
    <tbody id="slot-table"></tbody>
  </table>

  <script type="module">
    import { buildRsvpPrompt, buildSlotSelectPrompt } from './modules/prompt-builders.js';

    const sampleEvents = [
      {
        label: 'Standard event (single account)',
        summary: 'Team Meeting',
        date: '2025-01-15',
        eventId: 'abc123def456',
        calendarId: 'user@example.com'
      },
      {
        label: 'Multi-account event',
        summary: 'Cross-team Sync',
        date: '2025-03-08',
        eventId: 'xyz789_rr',
        calendarId: 'team-cal@group.calendar.google.com',
        accountId: 'work'
      },
      {
        label: 'All-day event',
        summary: 'Company Holiday',
        date: '2025-12-25',
        eventId: 'hol_20251225',
        calendarId: 'primary',
        accountId: 'personal'
      },
      {
        label: 'Event with special characters',
        summary: 'Design Review: "Phase 2" & Launch',
        date: '2025-06-01',
        eventId: 'dr_phase2_launch',
        calendarId: 'design@example.com'
      }
    ];

    const sampleSlots = [
      { startTime: '9 AM', endTime: '10 AM', date: '2025-01-15', label: 'Morning slot with date' },
      { startTime: '1:30 PM', endTime: '2:30 PM', date: '2025-07-04', label: 'Afternoon slot with date' },
      { startTime: '3 PM', endTime: '4:30 PM', date: undefined, label: 'Slot without date' }
    ];

    function clearChildren(el) {
      while (el.firstChild) el.removeChild(el.firstChild);
    }

    function render() {
      const locale = document.getElementById('locale-select').value;

      // RSVP table
      const rsvpBody = document.getElementById('rsvp-table');
      clearChildren(rsvpBody);
      for (const ev of sampleEvents) {
        const tr = document.createElement('tr');

        const tdEvent = document.createElement('td');
        const evLabel = document.createElement('div');
        evLabel.className = 'event-label';
        evLabel.textContent = ev.summary;
        tdEvent.appendChild(evLabel);
        const evMeta = document.createElement('div');
        evMeta.className = 'event-meta';
        evMeta.textContent = ev.label + ' | ' + ev.calendarId + (ev.accountId ? ' (' + ev.accountId + ')' : '');
        tdEvent.appendChild(evMeta);
        tr.appendChild(tdEvent);

        for (const action of ['accept', 'tentative', 'decline']) {
          const td = document.createElement('td');
          td.className = 'prompt-cell';
          td.textContent = buildRsvpPrompt({ ...ev, action, locale });
          tr.appendChild(td);
        }
        rsvpBody.appendChild(tr);
      }

      // Slot table
      const slotBody = document.getElementById('slot-table');
      clearChildren(slotBody);
      for (const slot of sampleSlots) {
        const tr = document.createElement('tr');

        const tdSlot = document.createElement('td');
        tdSlot.textContent = slot.label;
        tr.appendChild(tdSlot);

        const tdPrompt = document.createElement('td');
        tdPrompt.className = 'prompt-cell';
        tdPrompt.textContent = buildSlotSelectPrompt({
          startTime: slot.startTime,
          endTime: slot.endTime,
          date: slot.date,
          locale
        });
        tr.appendChild(tdPrompt);
        slotBody.appendChild(tr);
      }
    }

    document.getElementById('locale-select').addEventListener('change', render);
    render();
  </script>
</body>
</html>
